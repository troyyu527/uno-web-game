(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{3874:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return a(4874)}])},4874:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var s=a(5893),r=a(7294),n=a(1163),i=function(e){let{deck:t,deckCards:a,hit:r,play:n,showSwitch:i,isPlayOpt:l,setIsPlayOpt:d,avaCheck:c,getNextPlayer:o,mainDeck:u,discard:h,discardCards:m,setDiscardCards:g,mainCards:p,setMainCards:f,currentPlayer:x}=e,y=x===t.name;async function v(){await r(u,t),t.getWeb().lastElementChild.style.visibility="hidden",c(t.getBot(),h)?d(!0):(t.getWeb().lastElementChild.style.visibility="visible",o())}h.cards=m,u.cards=p,t.cards=a;let w=-1,j=1,b="";for(let e=0;e<20;e++){let t=w/10+"rem "+j/10+"rem var(--card-border-color)";19!==e&&(t+=","),w--,j++,b+=t}let k={boxShadow:b};return(0,s.jsxs)("div",{className:"main-deck",onClick:y&&!i[2]?v:null,children:[(0,s.jsx)("div",{className:"card-back top-card"}),(0,s.jsx)("div",{className:"card-back card-deck",style:k})]})},l=function(e){let{index:t,card:a,gap:r,isUserTurn:n,deckPos:i}=e,l={SUIT:{Red:{x:0,y:0},Green:{x:0,y:28},Blue:{x:0,y:42},Yellow:{x:0,y:14},Wild:{x:7.586*13,y:0}},VALUE:{0:{x:0,y:0},1:{x:7.586,y:0},2:{x:15.172,y:0},3:{x:7.586*3,y:0},4:{x:30.344,y:0},5:{x:37.93,y:0},6:{x:7.586*6,y:0},7:{x:7.586*7,y:0},8:{x:60.688,y:0},9:{x:68.274,y:0},Skip:{x:75.86,y:0},Reverse:{x:83.446,y:0},"Draw Two":{x:7.586*12,y:0},Wild:{x:0,y:0},"Draw Four":{x:0,y:56}}},d={zIndex:t+""};"player-bot"===i||"player-top"===i?d.marginLeft=r+"rem":d.marginTop=r+"rem";let c={backgroundPosition:.68+(l.SUIT[a.suit].x+l.VALUE[a.value].x)+"% "+(1+(l.SUIT[a.suit].y+l.VALUE[a.value].y))+"%"};return(0,s.jsxs)("div",{className:"card",style:d,children:[(0,s.jsx)("div",{className:"card-front ".concat(n?"card-highlighted":null),style:c}),(0,s.jsx)("div",{className:"card-back"})]})};let d=["Red","Green","Blue","Yellow"],c=["Wild"],o=["0","1","2","3","4","5","6","7","8","9","Skip","Reverse","Draw Two"],u=["Wild","Draw Four"];class h{get length(){return this.cards.length}getWeb(){return document.querySelector(this.selector)}getCard(e){return this.cards[e]}getHit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[];if(e>this.length)for(let e=0;e<this.length;e++)t.push(this.detTop());else for(let a=0;a<e;a++)t.push(this.detTop());return t}getTop(){return this.cards[0]}getBot(){return this.cards[this.length-1]}addTop(e){Array.isArray(e)?e.forEach(e=>{this.cards.unshift(e)}):this.cards.unshift(e)}addBot(e){Array.isArray(e)?e.forEach(e=>{this.cards.push(e)}):this.cards.push(e)}detTop(){let e=this.getTop();return this.cards.shift(),e}detBot(){let e=this.getBot();return this.cards.pop(),e}detCard(e){let t=this.getCard(e);return this.cards.splice(e,1),t}shuffle(){for(let e=this.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.cards[e],this.cards[t]]=[this.cards[t],this.cards[e]]}}recycle(){let e=this.detTop(),t=this.detBot();for(let e=this.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.cards[e],this.cards[t]]=[this.cards[t],this.cards[e]]}this.addTop(e),this.addBot(t)}clear(){this.cards=[]}constructor(e=[],t=null){this.cards=e,this.selector=t}}class m{setWtPt(e){this.points=e}setWildColor(e){this.wildColor=e}setPenalty(e){this.hasPenalty=e}constructor(e,t,a=null,s=null,r=!1){this.suit=e,this.value=t,this.points=a,this.wildColor=s,this.hasPenalty=r}}function g(e,t){return 0!==t.length&&("Wild"==e.suit||e.suit==t.getBot().suit||e.suit==t.getBot().wildColor||e.value==t.getBot().value)}function p(e,t){let a={Red:{trueColor:"#ff5555",posWild:"99.298% 1%",posDrawFour:"99.298% 57%"},Blue:{trueColor:"#5555ff",posWild:"99.298% 15%",posDrawFour:"99.298% 71%"},Yellow:{trueColor:"#ffaa00",posWild:"99.298% 29%",posDrawFour:"99.298% 85%"},Green:{trueColor:"#55aa55",posWild:"99.298% 43%",posDrawFour:"99.298% 99%"}},s=e.getWeb().lastElementChild.firstElementChild.firstElementChild,r=e.cards[e.length-1];r.setWildColor(t),s.style.backgroundImage="url('./img/cards/UNO_cards_deck_wild.svg')","Wild"==r.value?s.style.backgroundPosition=a[t].posWild:"Draw Four"==r.value&&(s.style.backgroundPosition=a[t].posDrawFour)}var f=function(e){let{showCard:t,isPause:a,pauseEvent:n,play:i,hit:h,broadcastSE:m,SE:f,isReverse:x,setIsReverse:y,avaCheck:v,showSwitch:w,setSwitch:j,getNextPlayer:b,userName:k,deck:C,mainDeck:S,discard:N,deckCards:D,setDeckCards:A,discardCards:P,setDiscardCards:E,mainCards:R,setMainCards:B,pos:W,currentPlayer:T,setCurrentPlayer:I}=e,M=e=>new Promise(t=>setTimeout(t,e)),U=3;async function _(){if(await M(1e3),await h(S,C),await M(1e3),v(C.getBot(),N)){let e=C.length-1,t=C.getBot();await i(C,N,e),G(t)}else b()}async function F(e){let t=e[Math.floor(Math.random()*e.length)],a=C.getCard(t);await M(1e3),await i(C,N,t),C.cards.length?G(a):I(null)}function G(e){1===C.cards.length&&m(f.call),"Wild"===e.suit?(function(e,t){let a=e.getMaxSuit(),s=null,r=Math.floor(Math.random()*a.length);if("Wild"===(s=a[r])||void 0===s){let e=["Red","Blue","Green","Yello"];r=Math.floor(Math.random()*e.length),s=e[r]}p(t,s)}(C,N),"Draw Four"===e.value?j([!1,!0,!1]):b()):"Skip"===e.value||"Reverse"===e.value||"Draw Two"===e.value?("Reverse"===e.value&&y(!x),j([!1,!0,!1])):b()}return C.cards=D,S.cards=R,N.cards=P,D&&(D.length>10&&D.length<=15&&(U=2),D.length>15&&(U=1)),(0,r.useEffect)(()=>{if(T===C.name&&!w[2]){let e,t,a;let s=(e=0,t=[],a=[],C.cards.forEach(s=>{var r,n,i,l;let h;let m=(r=s.suit,n=s.value,i=C.getMaxSuit(),l=C.getMaxValue(),h=0,d.includes(r)&&(h+=2,i.includes(r)&&(h+=3)),c.includes(r)&&(h+=-1),o.includes(n)&&(h+=1,l.includes(n)&&(h+=2)),u.includes(n)&&(h+=-1,l.includes(n)&&(h+=1)),h);s.setWtPt(m),0===t.length&&g(s,N)?(a.push(m),t.push(e)):m===a[0]&&g(s,N)?t.push(e):m>a[0]&&g(s,N)&&(a=[],(t=[]).push(e)),e++}),t);0===s.length?_():F(s)}},[T]),(0,s.jsx)("div",{className:"player ".concat(W),children:D.map((e,a)=>{let r=0!==a?U:0;return(0,s.jsx)("div",{className:"card-style",style:{visibility:t?"visible":"hidden"},children:(0,s.jsx)(l,{index:a,card:e,gap:r,deckPos:W})},a)})})};function x(e,t,a,s){let r,n,i=document.querySelector(".main-deck .top-card").getBoundingClientRect(),l=i.x+i.width/2,d=i.y+i.height/2,c=e.getBoundingClientRect(),o=c.x+c.width/2,u=c.y+c.height/2;r=l>o?l-o:-(o-l),n=d>u?d-u:-(u-d);let h=e.parentElement.classList,m=Array.prototype.includes.call(h,"player-bot"),g=Array.prototype.includes.call(h,"discard-pile"),p=0;(m||g)&&(p=180);let f=[{transform:"translate3d(".concat(r/10,"rem, ").concat(n/10,"rem, 10rem) rotateX(60deg) rotateZ(-45deg) rotateY(").concat(p,"deg)")},{transform:"translate3d(".concat((r+50)/10,"rem, ").concat((n+50)/10,"rem, 10rem) rotateX(60deg) rotateZ(-45deg) rotateY(").concat(p,"deg)"),offset:.4},{transform:"translate3d(0, 0, 10rem)",offset:.8},{transform:""}];e.animate(f,{duration:t,easing:"ease-out"}),a(s.deal)}var y=function(e){let{showCard:t,play:a,broadcastSE:r,SE:n,isReverse:i,setIsReverse:d,avaCheck:c,showSwitch:o,setSwitch:u,getNextPlayer:h,deck:m,mainDeck:g,discard:p,deckCards:f,setDeckCards:x,discardCards:y,setDiscardCards:v,mainCards:w,setMainCards:j,pos:b,currentPlayer:k,setCurrentPlayer:C}=e,S=k===m.name,N=3;async function D(e,t,s){if(c(s,p))await a(m,p,t),1===m.cards.length&&r(n.call),m.cards.length?"Wild"===s.suit?u([!0,!1,!1]):"Skip"===s.value||"Reverse"===s.value||"Draw Two"===s.value?("Reverse"===s.value&&d(!i),u([!1,!0,!1])):h():C(null);else{var l;let t;(t=(l=e.currentTarget).getBoundingClientRect()).x,t.width,t.y,t.height,l.animate([{transform:"translateY(-4rem)",offset:0},{transform:"translateY(-4rem) translateX(".concat(.5,"rem)"),offset:.25},{transform:"translateY(-4rem) translateX(-".concat(.5,"rem)"),offset:.5},{transform:"translateY(-4rem) translateX(".concat(.5,"rem)"),offset:.75},{transform:"translateY(-4rem)",offset:1}],{duration:200}),r(n.reject)}}return m.cards=f,g.cards=w,p.cards=y,f&&(f.length>10&&f.length<=15&&(N=2),f.length>15&&(N=1)),(0,s.jsx)("div",{className:"player ".concat(b),children:f.map((e,a)=>{let r=0!==a?N:0;return(0,s.jsx)("div",{className:"card-style",style:{visibility:t?"visible":"hidden"},onClick:S&&!o[2]?async t=>D(t,a,e):null,children:(0,s.jsx)(l,{index:a,card:e,gap:r,deckPos:b,isUserTurn:S})},a)})})},v=a(5675),w=a.n(v),j=function(e){let{name:t,pos:a,currentPlayer:n}=e,[i,l]=(0,r.useState)(Math.floor(11*Math.random())),d=!1;return n===t&&(d=!0),(0,s.jsxs)("div",{className:"profile ".concat(a," ").concat(d?"highlighted":""),children:[(0,s.jsx)("div",{children:t}),(0,s.jsx)(w(),{src:"/img/avatar_photo/avatar_".concat(i,".svg"),alt:"Avatar Photo",width:30,height:30})]})},b=function(e){let{cards:t,showCard:a}=e;return(0,s.jsx)("div",{className:"discard-pile",children:t.map((e,t)=>(0,s.jsx)("div",{className:"card-style",style:{visibility:a?"visible":"hidden"},children:(0,s.jsx)(l,{index:t,card:e})},t))})},k=function(e){let{setSwitch:t,getNextPlayer:a,discard:r,currentDiscardCards:n}=e;function i(e){p(r,e.currentTarget.getAttribute("color")),"Draw Four"===r.getBot().value?t([!1,!0,!1]):(t([!1,!1,!1]),a())}return r.cards=n,(0,s.jsxs)("div",{className:"selectColor",children:[(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#ff5555",borderRadius:"50% 0 0 0"},color:"Red",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#5555ff",borderRadius:"0 50% 0 0"},color:"Blue",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#ffaa00",borderRadius:"0 0 0 50%"},color:"Yellow",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#55aa55",borderRadius:"0 0 50% 0"},color:"Green",onClick:e=>i(e)})]})},C=function(e){let{isPause:t,setIsPause:a,currentPlayer:n,user:i}=e,[l,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e;return l&&(e=setTimeout(()=>{d(!1)},1e3)),()=>clearTimeout(e)},[l]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"setting",onClick:function(){n===i?a(!t):d(!0)}}),l&&n!==i&&(0,s.jsx)("div",{className:"warning",children:"Please wait until your turn!"})]})},S=function(e){let{isReverse:t}=e;return(0,s.jsx)("div",{className:t?"counter-clockwise direction":"clockwise direction"})},N=function(e){let{isBGM:t}=e,[a,n]=(0,r.useState)(30),[i,l]=(0,r.useState)(!1),d=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=d.current;e&&(t?e.play():e.pause(),e.volume=a/100)},[t,a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("audio",{ref:d,id:"bgm",loop:!0,src:"/audio/a-small-miracle.mp3",type:"audio/mpeg"}),(0,s.jsx)("div",{className:"music",onClick:()=>{l(!i)}}),i&&(0,s.jsx)("input",{type:"range",min:0,max:100,value:a,onChange:e=>{n(e.target.value)},className:"volume-slider"})]})},D=function(e){let t;let{broadcastSE:a,SE:n,isReverse:i,setIsReverse:l,setSwitch:d,getNextPlayer:c,discard:o,currentDiscardCards:u}=e,h=e=>new Promise(t=>setTimeout(t,e));async function m(){a(n.action),await h(1e3),c(),d([!1,!1,!0])}return o.cards=u,(0,r.useEffect)(()=>{m()},[]),o.getBot()&&("Skip"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/skip_black.svg')",backgroundSize:"300%"}),"Reverse"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/reverse_black.svg')",backgroundSize:"200%"}),"Draw Two"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/draw_two_black.svg')",backgroundSize:"190%"}),"Draw Four"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/draw_four_black.svg')",backgroundSize:"190%"})),(0,s.jsx)("div",{className:"action",style:t})},A=function(e){let t;let{showSwitch:a,setSwitch:n,getNextPlayer:i,hit:l,mainDeck:d,currentMainCards:c,deck:o,currentDeckCards:u,actCard:h}=e,m=e=>new Promise(t=>setTimeout(t,e));async function g(){if("Skip"===h.value&&await m(1e3),"Draw Two"===h.value)for(let e=0;e<2;e++)await l(d,o,500);if("Draw Four"===h.value)for(let e=0;e<4;e++)await l(d,o,500);n([!1,!1,!1]),i()}return d.cards=c,(0,r.useEffect)(()=>{g()},[]),"Skip"===h.value&&(t={backgroundImage:"url('./img/symbols/skip_white.svg')",width:"12rem",height:"12rem",backgroundSize:"200%"}),"Draw Two"===h.value&&(t={backgroundImage:"url('./img/symbols/draw_two_number_white.svg')",backgroundSize:"190%"}),"Draw Four"===h.value&&(t={backgroundImage:"url('./img/symbols/draw_four_number_white.svg')",backgroundSize:"190%"}),(0,s.jsx)("div",{className:"penalty",style:t})},P=function(e){let{play:t,broadcastSE:a,SE:r,isPlayOptcard:n,setIsPlayOpt:i,setSwitch:d,isReverse:c,setIsReverse:o,getNextPlayer:u,deck:h,deckCards:m,discard:g,discardCards:p}=e;async function f(){let e=h.getBot(),s=h.cards.length-1;i(!1),await t(h,g,s),1===h.cards.length&&a(r.call),"Wild"===e.suit?d([!0,!1,!1]):"Skip"===e.value||"Reverse"===e.value||"Draw Two"===e.value?("Reverse"===e.value&&o(!c),d([!1,!0,!1])):u()}return g.cards=p,h.cards=m,(0,s.jsxs)("div",{className:"play-keep-btn",children:[(0,s.jsx)(l,{card:h.getBot()}),(0,s.jsx)("div",{className:"play-btn",onClick:f,children:"PLAY"}),(0,s.jsx)("div",{className:"keep-btn",onClick:function(){h.getWeb().lastElementChild.style.visibility="visible",i(!1),u()},children:"KEEP"})]})},E=function(e){let{winner:t,backHome:a,startGame:r,setIsGameOver:n}=e;return(0,s.jsx)("div",{className:"gameover-body",children:(0,s.jsxs)("div",{id:"tudo",children:[(0,s.jsxs)("div",{className:"gameover",children:[(0,s.jsx)("p",{children:" GAME "}),(0,s.jsx)("p",{children:" OVER "})]}),(0,s.jsxs)("div",{className:"continue",children:[" ",(0,s.jsx)("p",{children:" CONTINUE? "})," "]}),(0,s.jsxs)("div",{className:"opcoes",children:[(0,s.jsx)("div",{className:"yes",onClick:()=>{n(!1),r()},children:"YES"}),(0,s.jsx)("div",{className:"no",onClick:()=>{a()},children:"NO"})]})]})})},R=function(e){let{toggleRule:t}=e;return(0,s.jsxs)("div",{className:"model-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("style",{children:".rule-content{\n                user-select: none;\n                background-image: linear-gradient(90deg,red,yellow);\n                border: 5px solid rgb(50,168,82);\n                padding: 1.5rem;\n              }\n              \n              h1{\n                display: flex;\n                justify-content:center ;\n                align-items: center;\n              }\n              \n              table,th,td{\n                border-collapse: collapse;\n                border: 2px solid;\n                padding: 0.25rem;\n              }"}),(0,s.jsxs)("div",{className:"rule-content",children:[(0,s.jsx)("h1",{children:"UNO CARD GAME RULE"}),(0,s.jsx)("p",{children:"To start a hand, seven cards are dealt to each player, and the top card of the remaining deck is flipped over and set aside to begin the discard pile. If the first top card of the remaining deck is a Wild or Wild Draw Four card, flip again and repeat until the card is neither Wild nor Wild Draw Four. The first player is randomly chosen to begin the game."}),(0,s.jsx)("p",{children:"On a player's turn, they must do one of the following:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Play one card matching the discard in color, number, or symbol"}),(0,s.jsx)("li",{children:"Play a Wild card or a Wild Draw Four card"}),(0,s.jsx)("li",{children:"Draw the top card from the deck and play it if possible"})]}),(0,s.jsx)("p",{children:"Cards are played by laying them face-up on top of the discard pile. Play initially proceeds clockwise around the table."}),(0,s.jsx)("p",{children:"Action or Wild cards have the following effects:"}),(0,s.jsx)("table",{children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Card"}),(0,s.jsx)("th",{children:"Effect when played from hand"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Skip"}),(0,s.jsx)("td",{children:"Next player in sequence misses a turn"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Reverse"}),(0,s.jsx)("td",{children:"Order of play switches directions (clockwise to counterclockwise, or vice versa)"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Draw Two (+2)"}),(0,s.jsx)("td",{children:"Next player in sequence draws two cards and misses a turn"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Wild"}),(0,s.jsx)("td",{children:"Player declares the next color to be matched (may be used on any turn even if the player has matching color)"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Wild Draw Four"}),(0,s.jsx)("td",{children:"Player declares the next color to be matched; next player in sequence draws four cards and misses a turn (may be used on any turn even if the player has matching color)"})]})]})}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"A player who draws a playable card from the deck must either play or keep that card and may play no other card from their hand on that turn."}),(0,s.jsx)("li",{children:"A player may play a Wild card or a Wild Draw Four card at any time, even if that player has other playable cards."}),(0,s.jsx)("li",{children:"When playing a Wild or Wild Draw Four card, a player may declare the current color as the next one to be matched."}),(0,s.jsx)("li",{children:"If the draw deck runs out during play, the top discard is set aside and the rest of the pile is shuffled to create a new deck. Play then proceeds normally."}),(0,s.jsx)("li",{children:"It is illegal to trade cards of any sort with another player."})]}),(0,s.jsx)("p",{children:'A player who plays their penultimate card must call "Uno" as a warning to the other players (the system will call for you)'}),(0,s.jsx)("p",{children:'The first player to get rid of their last card ("going out") wins.'})]})]}),(0,s.jsx)("div",{className:"back-btn",onClick:t,children:"Back"})]})},B=a(5753),W={src:"/uno-web-game//_next/static/media/file.65ae4e26.png",height:512,width:512,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAQAAABuBnYAAAAAaklEQVR42g3BPQ7BABgA0HcTp+nSaGh3iQsZLWJgcQmDUIbG32gRMXQQAwZLB/n0PRja+PoJA+iobIW2UkKqdnZ39XHQJxcmxkYuTrr0NKZmFm6OMgphbimESkai8fbyVCvlUNhb21l5SP8O1CpX9RMPuAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},T={src:"/uno-web-game//_next/static/media/empty.c848254d.png",height:512,width:512,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAQAAABuBnYAAAAAYklEQVR42g3HQQqCUBRA0YPRJKSZK8ggqUkpFDSIiH4SSdQKXIW6fB9cLhzYa9UeOiWCF2u9yt9gwwejuEkhcZQ74+0lU4syKbjUWDnxVBgscJVrKYM/B00g2cFW5+7mq2IGSQgMY5BaeigAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},I=function(e){let{title:t,dirToGame:a,loadData:r,showData:n,setShowData:i,getCurrentData:l,gameData:d,setGameData:c}=e;function o(e){let{data:n,index:i}=e;return(0,s.jsxs)("div",{className:"data-model",children:[(0,s.jsx)("div",{className:"container",onClick:"Save"===t?()=>(function(e){let t=window.prompt("Please enter the file name you want to save:"),a=l();B.Z.deleteGameData(a.user,e),a.index=e,a.name=t,B.Z.saveGameData(a).then(()=>{window.alert("Success to save the file!");let t=d||[];t[e]=a,c([...t])}).catch(e=>{window.alert("Fail to save the file, please try again")})})(i):()=>r(i,a),children:n?(0,s.jsx)("img",{src:W,alt:"File Saved",width:"230",height:"160"}):(0,s.jsx)("img",{src:T,alt:"Empty-File",width:"230",height:"160"})}),(0,s.jsx)("p",{children:n?n.name:"Empty File"})]})}return(0,s.jsxs)("div",{className:"model-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("style",{children:"\n          .data-content{\n            display:flex;\n            justify-content: center;\n          }\n          h1{\n            position:absolute;\n            top:10px;\n            left:10px;\n          }\n          .main-container{\n            top:15px;\n            display:flex;\n            flex-wrap:wrap;\n            \n            position:absolute;\n            height:80%;\n            width:80%;\n            border:5px solid blue;\n            \n          }\n          .data-model{\n            flex:1;\n            min-width: 40%;\n            border:5px solid gray;\n            align-items: center;\n          }\n          .container{\n            display:flex;\n            justify-content: center;\n            padding:5px;\n          }\n          .container:hover {\n            cursor:pointer;\n          }\n          .data-model:hover {\n            border:5px solid green;\n          }\n          p{\n            display:flex;\n            justify-content: center;\n            position:relative;\n          }\n          "}),(0,s.jsxs)("div",{className:"data-content",children:[(0,s.jsx)("h1",{children:t}),(0,s.jsxs)("div",{className:"main-container",children:[(0,s.jsx)(o,{index:0,data:d?d.find(e=>0===e.index):null},0),(0,s.jsx)(o,{index:1,data:d?d.find(e=>1===e.index):null},1),(0,s.jsx)(o,{index:2,data:d?d.find(e=>2===e.index):null},2),(0,s.jsx)(o,{index:3,data:d?d.find(e=>3===e.index):null},3)]})]})]}),(0,s.jsx)("div",{className:"btn-container",children:(0,s.jsx)("div",{className:"btn",onClick:function(){i(!n)},children:"Back"})})]})},M=function(e){let{user:t,isPause:a,setIsPause:n,backHome:i,showData:l,loadData:d,loadGame:c,dirToGame:o,setShowData:u,getCurrentData:h,gameData:m,setGameData:g}=e,[p,f]=(0,r.useState)(!1),[x,y]=(0,r.useState)("Load");function v(){f(!p)}function w(e){y(e),"Save"===e?B.Z.getGameData(t).then(e=>{g(e.data),u(!l)}):c()}return(0,s.jsxs)("div",{className:"model-setting",children:[!p&&!l&&(0,s.jsxs)("div",{className:"model-content-setting",children:[(0,s.jsx)("div",{className:"menu-bar",onClick:function(){n(!a)},children:"Resume"}),(0,s.jsx)("div",{className:"menu-bar",onClick:v,children:"Rule"}),(0,s.jsx)("div",{className:"menu-bar",onClick:()=>w("Save"),children:"Save"}),(0,s.jsx)("div",{className:"menu-bar",onClick:()=>w("Load"),children:"Load"}),(0,s.jsx)("div",{className:"menu-bar",onClick:i,children:"Exit the Game"})]}),p&&(0,s.jsx)(R,{toggleRule:v}),l&&(0,s.jsx)(I,{title:x,loadData:d,dirToGame:o,showData:l,setShowData:u,getCurrentData:h,gameData:m,setGameData:g})]})};class U extends h{updateStatus(){return this.cards.length>4?this.status="Normal":this.cards.length<5&&this.cards.length>2?this.status="Urgent":2==this.cards.length?this.status="Critical":1==this.cards.length?this.status="UNO":this.status="Winner"}getMaxSuit(){let e=[],t={};return this.cards.forEach(e=>{t[e.suit]?t[e.suit]++:t[e.suit]=1}),Object.entries(t).forEach(a=>{let[s,r]=a;0==e.length||t[e[0]]==r?e.push(s):t[e[0]]<r&&(e=[]).push(s)}),e}getMaxValue(){let e=[],t={};return this.cards.forEach(e=>{t[e.value]?t[e.value]++:t[e.value]=1}),Object.entries(t).forEach(a=>{let[s,r]=a;0==e.length||t[e[0]]==r?e.push(s):t[e[0]]<r&&(e=[]).push(s)}),e}constructor(e="NPC",t,a){super(a,t),this.name=e,this.status="Normal"}}var _=function(){let e=(0,n.useRouter)(),[t,a]=(0,r.useState)(!1),[l,g]=(0,r.useState)(!1),[p,v]=(0,r.useState)(!1),[w,R]=(0,r.useState)(!1),[W,T]=(0,r.useState)(B.Z.getCurrentUser()),[_,F]=(0,r.useState)([!1,!1,!1]),[G,O]=(0,r.useState)(!1),[Y,Z]=(0,r.useState)(!1),[L,Q]=(0,r.useState)(!0),[V,X]=(0,r.useState)(!1),[H,K]=(0,r.useState)(!1),[q,z]=(0,r.useState)(!1),J=e=>new Promise(t=>setTimeout(t,e)),$=W?W.data:"Player",ee=null,[et,ea]=(0,r.useState)([]),es=[$,"AI-1","AI-2","AI-3"],er=new U(es[0],".player-bot"),en=new U(es[1],".player-left"),ei=new U(es[2],".player-top"),el=new U(es[3],".player-right"),ed=[er,en,ei,el],ec=new h(function(){let e=[];for(let t=0;t<2;t++)for(let a=0;a<d.length;a++){let s=d[a];for(let a=0;a<o.length;a++){if(1===t&&0===a)continue;let r=o[a],n=new m(s,r);e.push(n)}}for(let t=0;t<4;t++)for(let t=0;t<c.length;t++){let a=c[t];for(let t=0;t<u.length;t++){let s=u[t],r=new m(a,s);e.push(r)}}return e}(),".main-deck"),eo=new h([],".discard-pile"),[eu,eh]=(0,r.useState)(es),[em,eg]=(0,r.useState)(null),[ep,ef]=(0,r.useState)(er.cards),[ex,ey]=(0,r.useState)(en.cards),[ev,ew]=(0,r.useState)(ei.cards),[ej,eb]=(0,r.useState)(el.cards),[ek,eC]=(0,r.useState)(ec.cards),[eS,eN]=(0,r.useState)(eo.cards),[eD,eA]=(0,r.useState)(null),eP=()=>{e.push("/")},eE=(0,r.useRef)(null),eR=(0,r.useRef)(null),eB=(0,r.useRef)(null),eW=(0,r.useRef)(null),eT=(0,r.useRef)(null),eI=(0,r.useRef)(null),eM=[{dom:eE,finishTime:0},{dom:eR,finishTime:0},{dom:eB,finishTime:0},{dom:eW,finishTime:0},{dom:eT,finishTime:0},{dom:eI,finishTime:0}],eU={deal:{path:"audio/card-delt.mp3",type:"audio/mpeg",duration:500,volume:1},play:{path:"audio/card-play.mp3",type:"audio/mpeg",duration:500,volume:1},action:{path:"audio/card-action.mp3",type:"audio/mpeg",duration:500,volume:1},reject:{path:"audio/card-reject.mp3",type:"audio/mpeg",duration:500,volume:1},call:{path:"audio/uno-call.mp3",type:"audio/mpeg",duration:500,volume:.5},gameOver:{path:"audio/game-win.mp3",type:"audio/mpeg",duration:2e3,volume:1}};function e_(e){let t=new Date().getTime(),a=eM.find(e=>e.finishTime<t);a?(a.dom.current.setAttribute("src",e.path),a.dom.current.setAttribute("type",e.type),a.dom.current.volume=e.volume,a.finishTime=t+e.duration,setTimeout(()=>a.dom.current.play(),0)):console.log("Unable to play",e.path)}(0,r.useEffect)(()=>{l&&(0===ep.length&&(ee=er.name),0===ex.length&&(ee=en.name),0===ev.length&&(ee=ei.name),0===ej.length&&(ee=el.name)),ee&&(Q(!1),e_(eU.gameOver),eA(ee),X(!0))},[em,et]);let eF=async()=>{g(!0),ee=null,W&&($=W.user),ec.shuffle(),await J(500);let e=0;for(;e<7;){for(let e of ed)await eG(ec,e,200);e++}do await eG(ec,eo,1e3);while("Wild"==eo.getBot().suit);eZ()};async function eG(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,s=e.getHit(1);for(t.addBot(s),eY(),await J(1),t.name?x(t.getWeb().lastElementChild,a,e_,eU):x(eo.getWeb().lastElementChild,a,e_,eU);eo.length>10;){let t=eo.getHit();e.addBot(t),e.shuffle()}await J(a+1),z(!0)}async function eO(e,t,a){var s;let r,n,i,l,d,c,o,u,h,m,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,p=e.getWeb().children[a].getBoundingClientRect(),f=e.detCard(a);t.addBot(f),eY(),await J(1),n=(r=(s=t.getWeb().lastElementChild).getBoundingClientRect()).x+r.width/2,i=r.y+r.height/2,l=p.x+p.width/2,d=p.y+p.height/2,c=180,("AI-1"!==e.name||"AI-2"!==e.name||"AI-3"!==e.name)&&(c=0),o=Math.floor(360*Math.random()-180),u=Math.floor(20*Math.random())-10,h=Math.floor(20*Math.random())-10,m=[{transform:"translate3d(".concat((l-n)/10,"rem, ").concat((d-i)/10,"rem, 10rem) rotateY(").concat(c,"deg)")},{transform:"translate3d(0, 0, 10rem) rotate(".concat(o/2,"deg)"),offset:.5},{transform:"translateX(".concat(u/10,"rem) translateY(").concat(h/10,"rem) rotate(").concat(o,"deg)")}],s.lastElementChild.animate(m,{duration:g,easing:"ease-out"}),s.lastElementChild.style.transform="translateX(".concat(u/10,"rem) translateY(").concat(h/10,"rem) rotate(").concat(o,"deg)"),e_(eU.play),await J(g+1),z(!0)}function eY(){ef([...er.cards]),ey([...en.cards]),ew([...ei.cards]),eb([...el.cards]),eC([...ec.cards]),eN([...eo.cards])}function eZ(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=1;for(t&&(a=2);0!==a;)G?(e=eu.pop(),eu.unshift(e)):(e=eu.shift(),eu.push(e)),a--;eh([...eu]),eg(e)}function eL(){B.Z.getGameData($).then(e=>{ea(e.data),K(!H)})}function eQ(e,t){if(et[e]){let s;et.forEach((t,a)=>{t.index===e&&(s=a)});let r=et[s],[n,i,l,d,c,o]=[[],[],[],[],[],[]];r.p1.forEach(e=>n.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),r.p2.forEach(e=>i.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),r.p3.forEach(e=>l.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),r.p4.forEach(e=>d.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),r.main.forEach(e=>c.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),r.discard.forEach(e=>o.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),er.cards=n,en.cards=i,ei.cards=l,el.cards=d,ec.cards=c,eo.cards=o,eY(),eg(r.currentPlayer),eh(r.currentPlayerQueue),O(r.isReverse),z(!0),K(!H),t?g(!0):a(!1)}}function eV(){}function eX(e,t){return 0!==t.length&&("Wild"==e.suit||e.suit==t.getBot().suit||e.suit==t.getBot().wildColor||e.value==t.getBot().value)}return(0,s.jsxs)(s.Fragment,{children:[V&&(0,s.jsx)(E,{winner:eD,backHome:eP,startGame:eF,setIsGameOver:X}),!l&&!V&&!H&&(0,s.jsx)("div",{className:"model-menu",children:(0,s.jsxs)("div",{className:"model-content-menu",children:[(0,s.jsx)("div",{className:"bar-btn",onClick:eF,children:"Start"}),(0,s.jsx)("div",{className:"bar-btn",onClick:eL,children:"Load"}),(0,s.jsx)("div",{className:"bar-btn",onClick:eP,children:"Exit"})]})}),H&&(0,s.jsx)("div",{className:"model-setting",children:(0,s.jsx)(I,{title:"Load",toggleDataPage:eL,showData:H,setShowData:K,dirToGame:!0,loadData:eQ,gameData:et,setGameData:ea})}),l&&!V&&(0,s.jsxs)("div",{className:"game-board",children:[(0,s.jsx)("div",{className:"deck box1",children:(0,s.jsx)(i,{deck:er,deckCards:ep,hit:eG,play:eO,showSwitch:_,isPlayOpt:Y,setIsPlayOpt:Z,avaCheck:eX,getNextPlayer:eZ,mainDeck:ec,discard:eo,mainCards:ek,setMainCards:eC,discardCards:eS,setDiscardCards:eN,currentPlayer:em})}),(0,s.jsxs)("div",{className:"deck box2",children:[(0,s.jsx)(j,{name:ei.name,pos:"p3",currentPlayer:em}),_[2]&&em===ei.name&&(0,s.jsx)(A,{showSwitch:_,setSwitch:F,getNextPlayer:eZ,hit:eG,mainDeck:ec,currentMainCards:ek,deck:ei,currentDeckCards:ev,actCard:eS[eS.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eV,play:eO,hit:eG,broadcastSE:e_,SE:eU,isReverse:G,setIsReverse:O,userName:er.name,avaCheck:eX,showSwitch:_,setSwitch:F,getNextPlayer:eZ,deck:ei,mainDeck:ec,discard:eo,deckCards:ev,setDeckCards:ew,discardCards:eS,setDiscardCards:eN,mainCards:ek,setMainCards:eC,pos:"player-top",currentPlayer:em,setCurrentPlayer:eg})]}),(0,s.jsxs)("div",{className:"deck box3",children:[(0,s.jsx)(N,{isBGM:L}),(0,s.jsx)(C,{isPause:t,setIsPause:a,currentPlayer:em,user:$})]}),(0,s.jsxs)("div",{className:"deck box4",children:[(0,s.jsx)(j,{name:en.name,pos:"p2",currentPlayer:em}),_[2]&&em===en.name&&(0,s.jsx)(A,{showSwitch:_,setSwitch:F,getNextPlayer:eZ,hit:eG,mainDeck:ec,currentMainCards:ek,deck:en,currentDeckCards:ex,actCard:eS[eS.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eV,play:eO,hit:eG,broadcastSE:e_,SE:eU,isReverse:G,setIsReverse:O,userName:er.name,avaCheck:eX,showSwitch:_,setSwitch:F,getNextPlayer:eZ,deck:en,mainDeck:ec,discard:eo,deckCards:ex,setDeckCards:ey,discardCards:eS,setDiscardCards:eN,mainCards:ek,setMainCards:eC,pos:"player-left",currentPlayer:em,setCurrentPlayer:eg})]}),(0,s.jsxs)("div",{className:"deck box5",children:[_[0]&&(0,s.jsx)(k,{setSwitch:F,getNextPlayer:eZ,discard:eo,currentDiscardCards:eS}),_[1]&&(0,s.jsx)(D,{broadcastSE:e_,SE:eU,isReverse:G,setIsReverse:O,setSwitch:F,getNextPlayer:eZ,discard:eo,currentDiscardCards:eS}),(0,s.jsx)(b,{cards:eS,showCard:q}),(0,s.jsx)(S,{isReverse:G})]}),(0,s.jsxs)("div",{className:"deck box6",children:[(0,s.jsx)(j,{name:el.name,pos:"p4",currentPlayer:em}),_[2]&&em===el.name&&(0,s.jsx)(A,{showSwitch:_,setSwitch:F,getNextPlayer:eZ,hit:eG,mainDeck:ec,currentMainCards:ek,deck:el,currentDeckCards:ej,actCard:eS[eS.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eV,play:eO,hit:eG,broadcastSE:e_,SE:eU,isReverse:G,setIsReverse:O,userName:er.name,avaCheck:eX,showSwitch:_,setSwitch:F,getNextPlayer:eZ,deck:el,mainDeck:ec,discard:eo,deckCards:ej,setDeckCards:eb,discardCards:eS,setDiscardCards:eN,mainCards:ek,setMainCards:eC,pos:"player-right",currentPlayer:em,setCurrentPlayer:eg})]}),(0,s.jsx)("div",{className:"deck box7"}),(0,s.jsxs)("div",{className:"deck box8",children:[(0,s.jsx)(j,{name:er.name,pos:"p1",currentPlayer:em}),_[2]&&em===er.name&&(0,s.jsx)(A,{showSwitch:_,setSwitch:F,getNextPlayer:eZ,hit:eG,mainDeck:ec,currentMainCards:ek,deck:er,currentDeckCards:ep,actCard:eS[eS.length-1]}),Y&&em===er.name&&(0,s.jsx)(P,{play:eO,broadcastSE:e_,SE:eU,isPlayOpt:Y,setIsPlayOpt:Z,setSwitch:F,isReverse:G,setIsReverse:O,getNextPlayer:eZ,deck:er,deckCards:ep,discard:eo,discardCards:eS}),(0,s.jsx)(y,{showCard:q,play:eO,broadcastSE:e_,SE:eU,avaCheck:eX,showSwitch:_,setSwitch:F,isReverse:G,setIsReverse:O,getNextPlayer:eZ,deck:er,mainDeck:ec,discard:eo,deckCards:ep,setDeckCards:ef,discardCards:eS,setDiscardCards:eN,mainCards:ek,setMainCards:eC,pos:"player-bot",currentPlayer:em,setCurrentPlayer:eg})]}),(0,s.jsx)("div",{className:"deck box9"})]}),t&&(0,s.jsx)(M,{user:$,isPause:t,setIsPause:a,backHome:eP,showData:H,loadData:eQ,loadGame:eL,dirToGame:!1,setShowData:K,getCurrentData:function(){return{user:W.data,date:new Date().getTime(),currentPlayer:em,currentPlayerQueue:eu,isReverse:G,main:ek,discard:eS,p1:ep,p2:ex,p3:ev,p4:ej}},gameData:et,setGameData:ea}),(0,s.jsx)("audio",{ref:eE}),(0,s.jsx)("audio",{ref:eR}),(0,s.jsx)("audio",{ref:eB}),(0,s.jsx)("audio",{ref:eW}),(0,s.jsx)("audio",{ref:eT}),(0,s.jsx)("audio",{ref:eI})]})}},5753:function(e,t,a){"use strict";var s=a(6154);let r="https://uno-game-server.glitch.me/api";t.Z=new class{login(e,t){return s.Z.post(r+"/user/login",{username:e,password:t})}logout(){localStorage.removeItem("user")}register(e,t,a,n,i){return s.Z.post(r+"/user/register",{username:e,email:t,password:a,gender:n,role:i})}getCurrentUser(){return JSON.parse(localStorage.getItem("user"))||null}modifyUser(e,t,a,n,i){return s.Z.patch(r+"/user/modify/"+e,{username:t,email:a,password:n,gender:i})}deleteUser(e){return s.Z.delete(r+"/user/delete/"+e)}getGameData(e){return s.Z.get(r+"/gameData/"+e)}saveGameData(e){let{user:t,index:a,name:n,date:i,img:l,currentPlayer:d,currentPlayerQueue:c,isReverse:o,main:u,discard:h,p1:m,p2:g,p3:p,p4:f}=e;return s.Z.post(r+"/gameData/data",{user:t,index:a,name:n,date:i,img:l,currentPlayer:d,currentPlayerQueue:c,isReverse:o,main:u,discard:h,p1:m,p2:g,p3:p,p4:f})}deleteGameData(e,t){return s.Z.delete(r+"/gameData/"+e+"/"+t)}}}},function(e){e.O(0,[827,675,774,888,179],function(){return e(e.s=3874)}),_N_E=e.O()}]);