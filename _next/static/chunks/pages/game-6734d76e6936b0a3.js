(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{3874:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return a(344)}])},344:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var s=a(5893),r=a(7294),n=a(1163),i=function(e){let{deck:t,deckCards:a,hit:r,play:n,showSwitch:i,isPlayOpt:l,setIsPlayOpt:d,avaCheck:c,getNextPlayer:o,mainDeck:u,discard:h,discardCards:m,setDiscardCards:g,mainCards:p,setMainCards:f,currentPlayer:x}=e,y=x===t.name;async function v(){await r(u,t),t.getWeb().lastElementChild.style.visibility="hidden",c(t.getBot(),h)?d(!0):(t.getWeb().lastElementChild.style.visibility="visible",o())}h.cards=m,u.cards=p,t.cards=a;let w=-1,j=1,b="";for(let e=0;e<20;e++){let t=w/10+"rem "+j/10+"rem var(--card-border-color)";19!==e&&(t+=","),w--,j++,b+=t}let k={boxShadow:b};return(0,s.jsxs)("div",{className:"main-deck",onClick:y&&!i[2]?v:null,children:[(0,s.jsx)("div",{className:"card-back top-card"}),(0,s.jsx)("div",{className:"card-back card-deck",style:k})]})},l=function(e){let{index:t,card:a,gap:r,isUserTurn:n,deckPos:i}=e,l={SUIT:{Red:{x:0,y:0},Green:{x:0,y:28},Blue:{x:0,y:42},Yellow:{x:0,y:14},Wild:{x:7.586*13,y:0}},VALUE:{0:{x:0,y:0},1:{x:7.586,y:0},2:{x:15.172,y:0},3:{x:7.586*3,y:0},4:{x:30.344,y:0},5:{x:37.93,y:0},6:{x:7.586*6,y:0},7:{x:7.586*7,y:0},8:{x:60.688,y:0},9:{x:68.274,y:0},Skip:{x:75.86,y:0},Reverse:{x:83.446,y:0},"Draw Two":{x:7.586*12,y:0},Wild:{x:0,y:0},"Draw Four":{x:0,y:56}}},d={zIndex:t+""};"player-bot"===i||"player-top"===i?d.marginLeft=r+"rem":d.marginTop=r+"rem";let c={backgroundPosition:.68+(l.SUIT[a.suit].x+l.VALUE[a.value].x)+"% "+(1+(l.SUIT[a.suit].y+l.VALUE[a.value].y))+"%"};return(0,s.jsxs)("div",{className:"card",style:d,children:[(0,s.jsx)("div",{className:"card-front ".concat(n?"card-highlighted":null),style:c}),(0,s.jsx)("div",{className:"card-back"})]})};let d=["Red","Green","Blue","Yellow"],c=["Wild"],o=["0","1","2","3","4","5","6","7","8","9","Skip","Reverse","Draw Two"],u=["Wild","Draw Four"];class h{get length(){return this.cards.length}getWeb(){return document.querySelector(this.selector)}getCard(e){return this.cards[e]}getHit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=[];if(e>this.length)for(let e=0;e<this.length;e++)t.push(this.detTop());else for(let a=0;a<e;a++)t.push(this.detTop());return t}getTop(){return this.cards[0]}getBot(){return this.cards[this.length-1]}addTop(e){Array.isArray(e)?e.forEach(e=>{this.cards.unshift(e)}):this.cards.unshift(e)}addBot(e){Array.isArray(e)?e.forEach(e=>{this.cards.push(e)}):this.cards.push(e)}detTop(){let e=this.getTop();return this.cards.shift(),e}detBot(){let e=this.getBot();return this.cards.pop(),e}detCard(e){let t=this.getCard(e);return this.cards.splice(e,1),t}shuffle(){for(let e=this.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.cards[e],this.cards[t]]=[this.cards[t],this.cards[e]]}}recycle(){let e=this.detTop(),t=this.detBot();for(let e=this.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[this.cards[e],this.cards[t]]=[this.cards[t],this.cards[e]]}this.addTop(e),this.addBot(t)}clear(){this.cards=[]}constructor(e=[],t=null){this.cards=e,this.selector=t}}class m{setWtPt(e){this.points=e}setWildColor(e){this.wildColor=e}setPenalty(e){this.hasPenalty=e}constructor(e,t,a=null,s=null,r=!1){this.suit=e,this.value=t,this.points=a,this.wildColor=s,this.hasPenalty=r}}function g(e,t){return 0!==t.length&&("Wild"==e.suit||e.suit==t.getBot().suit||e.suit==t.getBot().wildColor||e.value==t.getBot().value)}function p(e,t){let a={Red:{trueColor:"#ff5555",posWild:"99.298% 1%",posDrawFour:"99.298% 57%"},Blue:{trueColor:"#5555ff",posWild:"99.298% 15%",posDrawFour:"99.298% 71%"},Yellow:{trueColor:"#ffaa00",posWild:"99.298% 29%",posDrawFour:"99.298% 85%"},Green:{trueColor:"#55aa55",posWild:"99.298% 43%",posDrawFour:"99.298% 99%"}},s=e.getWeb().lastElementChild.firstElementChild.firstElementChild,r=e.cards[e.length-1];r.setWildColor(t),s.style.backgroundImage="url('./img/cards/UNO_cards_deck_wild.svg')","Wild"==r.value?s.style.backgroundPosition=a[t].posWild:"Draw Four"==r.value&&(s.style.backgroundPosition=a[t].posDrawFour)}var f=function(e){let{showCard:t,isPause:a,pauseEvent:n,play:i,hit:h,broadcastSE:m,SE:f,isReverse:x,setIsReverse:y,avaCheck:v,showSwitch:w,setSwitch:j,getNextPlayer:b,userName:k,deck:C,mainDeck:N,discard:S,deckCards:D,setDeckCards:P,discardCards:E,setDiscardCards:R,mainCards:T,setMainCards:W,pos:B,currentPlayer:I,setCurrentPlayer:M}=e,_=e=>new Promise(t=>setTimeout(t,e)),A=3;async function F(){if(await _(1e3),await h(N,C),await _(1e3),v(C.getBot(),S)){let e=C.length-1,t=C.getBot();await i(C,S,e),O(t)}else b()}async function G(e){let t=e[Math.floor(Math.random()*e.length)],a=C.getCard(t);await _(1e3),await i(C,S,t),C.cards.length?O(a):M(null)}function O(e){1===C.cards.length&&m(f.call),"Wild"===e.suit?(function(e,t){let a=e.getMaxSuit(),s=null,r=Math.floor(Math.random()*a.length);if("Wild"===(s=a[r])||void 0===s){let e=["Red","Blue","Green","Yello"];r=Math.floor(Math.random()*e.length),s=e[r]}p(t,s)}(C,S),"Draw Four"===e.value?j([!1,!0,!1]):b()):"Skip"===e.value||"Reverse"===e.value||"Draw Two"===e.value?("Reverse"===e.value&&y(!x),j([!1,!0,!1])):b()}return C.cards=D,N.cards=T,S.cards=E,D&&(D.length>10&&D.length<=15&&(A=2),D.length>15&&(A=1)),(0,r.useEffect)(()=>{if(I===C.name&&!w[2]){let e,t,a;let s=(e=0,t=[],a=[],C.cards.forEach(s=>{var r,n,i,l;let h;let m=(r=s.suit,n=s.value,i=C.getMaxSuit(),l=C.getMaxValue(),h=0,d.includes(r)&&(h+=2,i.includes(r)&&(h+=3)),c.includes(r)&&(h+=-1),o.includes(n)&&(h+=1,l.includes(n)&&(h+=2)),u.includes(n)&&(h+=-1,l.includes(n)&&(h+=1)),h);s.setWtPt(m),0===t.length&&g(s,S)?(a.push(m),t.push(e)):m===a[0]&&g(s,S)?t.push(e):m>a[0]&&g(s,S)&&(a=[],(t=[]).push(e)),e++}),t);0===s.length?F():G(s)}},[I]),(0,s.jsx)("div",{className:"player ".concat(B),children:D.map((e,a)=>{let r=0!==a?A:0;return(0,s.jsx)("div",{className:"card-style",style:{visibility:t?"visible":"hidden"},children:(0,s.jsx)(l,{index:a,card:e,gap:r,deckPos:B})},a)})})};function x(e,t,a,s){let r,n,i=document.querySelector(".main-deck .top-card").getBoundingClientRect(),l=i.x+i.width/2,d=i.y+i.height/2,c=e.getBoundingClientRect(),o=c.x+c.width/2,u=c.y+c.height/2;r=l>o?l-o:-(o-l),n=d>u?d-u:-(u-d);let h=e.parentElement.classList,m=Array.prototype.includes.call(h,"player-bot"),g=Array.prototype.includes.call(h,"discard-pile"),p=0;(m||g)&&(p=180);let f=[{transform:"translate3d(".concat(r/10,"rem, ").concat(n/10,"rem, 10rem) rotateX(60deg) rotateZ(-45deg) rotateY(").concat(p,"deg)")},{transform:"translate3d(".concat((r+50)/10,"rem, ").concat((n+50)/10,"rem, 10rem) rotateX(60deg) rotateZ(-45deg) rotateY(").concat(p,"deg)"),offset:.4},{transform:"translate3d(0, 0, 10rem)",offset:.8},{transform:""}];e.animate(f,{duration:t,easing:"ease-out"}),a(s.deal)}var y=function(e){let{showCard:t,play:a,broadcastSE:r,SE:n,isReverse:i,setIsReverse:d,avaCheck:c,showSwitch:o,setSwitch:u,getNextPlayer:h,deck:m,mainDeck:g,discard:p,deckCards:f,setDeckCards:x,discardCards:y,setDiscardCards:v,mainCards:w,setMainCards:j,pos:b,currentPlayer:k,setCurrentPlayer:C}=e,N=k===m.name,S=3;async function D(e,t,s){if(c(s,p))await a(m,p,t),1===m.cards.length&&r(n.call),m.cards.length?"Wild"===s.suit?u([!0,!1,!1]):"Skip"===s.value||"Reverse"===s.value||"Draw Two"===s.value?("Reverse"===s.value&&d(!i),u([!1,!0,!1])):h():C(null);else{var l;let t;(t=(l=e.currentTarget).getBoundingClientRect()).x,t.width,t.y,t.height,l.animate([{transform:"translateY(-4rem)",offset:0},{transform:"translateY(-4rem) translateX(".concat(.5,"rem)"),offset:.25},{transform:"translateY(-4rem) translateX(-".concat(.5,"rem)"),offset:.5},{transform:"translateY(-4rem) translateX(".concat(.5,"rem)"),offset:.75},{transform:"translateY(-4rem)",offset:1}],{duration:200}),r(n.reject)}}return m.cards=f,g.cards=w,p.cards=y,f&&(f.length>10&&f.length<=15&&(S=2),f.length>15&&(S=1)),(0,s.jsx)("div",{className:"player ".concat(b),children:f.map((e,a)=>{let r=0!==a?S:0;return(0,s.jsx)("div",{className:"card-style",style:{visibility:t?"visible":"hidden"},onClick:N&&!o[2]?async t=>D(t,a,e):null,children:(0,s.jsx)(l,{index:a,card:e,gap:r,deckPos:b,isUserTurn:N})},a)})})},v=a(5675),w=a.n(v),j=function(e){let{name:t,pos:a,currentPlayer:n}=e,[i,l]=(0,r.useState)(Math.floor(11*Math.random())),d=!1;return n===t&&(d=!0),(0,s.jsxs)("div",{className:"profile ".concat(a," ").concat(d?"highlighted":""),children:[(0,s.jsx)("div",{children:t}),(0,s.jsx)(w(),{src:"./img/avatar_photo/avatar_".concat(i,".svg"),alt:"Avatar Photo",width:30,height:30})]})},b=function(e){let{cards:t,showCard:a}=e;return(0,s.jsx)("div",{className:"discard-pile",children:t.map((e,t)=>(0,s.jsx)("div",{className:"card-style",style:{visibility:a?"visible":"hidden"},children:(0,s.jsx)(l,{index:t,card:e})},t))})},k=function(e){let{setSwitch:t,getNextPlayer:a,discard:r,currentDiscardCards:n}=e;function i(e){p(r,e.currentTarget.getAttribute("color")),"Draw Four"===r.getBot().value?t([!1,!0,!1]):(t([!1,!1,!1]),a())}return r.cards=n,(0,s.jsxs)("div",{className:"selectColor",children:[(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#ff5555",borderRadius:"50% 0 0 0"},color:"Red",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#5555ff",borderRadius:"0 50% 0 0"},color:"Blue",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#ffaa00",borderRadius:"0 0 0 50%"},color:"Yellow",onClick:e=>i(e)}),(0,s.jsx)("div",{className:"color",style:{backgroundColor:"#55aa55",borderRadius:"0 0 50% 0"},color:"Green",onClick:e=>i(e)})]})},C=function(e){let{isPause:t,setIsPause:a,currentPlayer:n,user:i}=e,[l,d]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e;return l&&(e=setTimeout(()=>{d(!1)},1e3)),()=>clearTimeout(e)},[l]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"setting",onClick:function(){n===i?a(!t):d(!0)}}),l&&n!==i&&(0,s.jsx)("div",{className:"warning",children:"Please wait until your turn!"})]})},N=function(e){let{isReverse:t}=e;return(0,s.jsx)("div",{className:t?"counter-clockwise direction":"clockwise direction"})},S=function(e){let{isBGM:t}=e,[a,n]=(0,r.useState)(30),[i,l]=(0,r.useState)(!1),d=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=d.current;e&&(t?e.play():e.pause(),e.volume=a/100)},[t,a]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("audio",{ref:d,id:"bgm",loop:!0,src:"./audio/a-small-miracle.mp3",type:"audio/mpeg"}),(0,s.jsx)("div",{className:"music",onClick:()=>{l(!i)}}),i&&(0,s.jsx)("input",{type:"range",min:0,max:100,value:a,onChange:e=>{n(e.target.value)},className:"volume-slider"})]})},D=function(e){let t;let{broadcastSE:a,SE:n,isReverse:i,setIsReverse:l,setSwitch:d,getNextPlayer:c,discard:o,currentDiscardCards:u}=e,h=e=>new Promise(t=>setTimeout(t,e));async function m(){a(n.action),await h(1e3),c(),d([!1,!1,!0])}return o.cards=u,(0,r.useEffect)(()=>{m()},[]),o.getBot()&&("Skip"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/skip_black.svg')",backgroundSize:"300%"}),"Reverse"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/reverse_black.svg')",backgroundSize:"200%"}),"Draw Two"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/draw_two_black.svg')",backgroundSize:"190%"}),"Draw Four"===o.getBot().value&&(t={backgroundImage:"url('./img/symbols/draw_four_black.svg')",backgroundSize:"190%"})),(0,s.jsx)("div",{className:"action",style:t})},P=function(e){let t;let{showSwitch:a,setSwitch:n,getNextPlayer:i,hit:l,mainDeck:d,currentMainCards:c,deck:o,currentDeckCards:u,actCard:h}=e,m=e=>new Promise(t=>setTimeout(t,e));async function g(){if("Skip"===h.value&&await m(1e3),"Draw Two"===h.value)for(let e=0;e<2;e++)await l(d,o,500);if("Draw Four"===h.value)for(let e=0;e<4;e++)await l(d,o,500);n([!1,!1,!1]),i()}return d.cards=c,(0,r.useEffect)(()=>{g()},[]),"Skip"===h.value&&(t={backgroundImage:"url('./img/symbols/skip_white.svg')",width:"12rem",height:"12rem",backgroundSize:"200%"}),"Draw Two"===h.value&&(t={backgroundImage:"url('./img/symbols/draw_two_number_white.svg')",backgroundSize:"190%"}),"Draw Four"===h.value&&(t={backgroundImage:"url('./img/symbols/draw_four_number_white.svg')",backgroundSize:"190%"}),(0,s.jsx)("div",{className:"penalty",style:t})},E=function(e){let{play:t,broadcastSE:a,SE:r,isPlayOptcard:n,setIsPlayOpt:i,setSwitch:d,isReverse:c,setIsReverse:o,getNextPlayer:u,deck:h,deckCards:m,discard:g,discardCards:p}=e;async function f(){let e=h.getBot(),s=h.cards.length-1;i(!1),await t(h,g,s),1===h.cards.length&&a(r.call),"Wild"===e.suit?d([!0,!1,!1]):"Skip"===e.value||"Reverse"===e.value||"Draw Two"===e.value?("Reverse"===e.value&&o(!c),d([!1,!0,!1])):u()}return g.cards=p,h.cards=m,(0,s.jsxs)("div",{className:"play-keep-btn",children:[(0,s.jsx)(l,{card:h.getBot()}),(0,s.jsx)("div",{className:"play-btn",onClick:f,children:"PLAY"}),(0,s.jsx)("div",{className:"keep-btn",onClick:function(){h.getWeb().lastElementChild.style.visibility="visible",i(!1),u()},children:"KEEP"})]})},R=function(e){let{winner:t,backHome:a,startGame:r,setIsGameOver:n}=e;return(0,s.jsx)("div",{className:"gameover-body",children:(0,s.jsxs)("div",{id:"tudo",children:[(0,s.jsxs)("div",{className:"gameover",children:[(0,s.jsx)("p",{children:" GAME "}),(0,s.jsx)("p",{children:" OVER "})]}),(0,s.jsxs)("div",{className:"continue",children:[" ",(0,s.jsx)("p",{children:" CONTINUE? "})," "]}),(0,s.jsxs)("div",{className:"opcoes",children:[(0,s.jsx)("div",{className:"yes",onClick:()=>{n(!1),r()},children:"YES"}),(0,s.jsx)("div",{className:"no",onClick:()=>{a()},children:"NO"})]})]})})},T=function(e){let{toggleRule:t}=e;return(0,s.jsxs)("div",{className:"model-content",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("style",{children:".rule-content{\n                user-select: none;\n                background-image: linear-gradient(90deg,red,yellow);\n                border: 5px solid rgb(50,168,82);\n                padding: 1.5rem;\n              }\n              \n              h1{\n                display: flex;\n                justify-content:center ;\n                align-items: center;\n              }\n              \n              table,th,td{\n                border-collapse: collapse;\n                border: 2px solid;\n                padding: 0.25rem;\n              }"}),(0,s.jsxs)("div",{className:"rule-content",children:[(0,s.jsx)("h1",{children:"UNO CARD GAME RULE"}),(0,s.jsx)("p",{children:"To start a hand, seven cards are dealt to each player, and the top card of the remaining deck is flipped over and set aside to begin the discard pile. If the first top card of the remaining deck is a Wild or Wild Draw Four card, flip again and repeat until the card is neither Wild nor Wild Draw Four. The first player is randomly chosen to begin the game."}),(0,s.jsx)("p",{children:"On a player's turn, they must do one of the following:"}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Play one card matching the discard in color, number, or symbol"}),(0,s.jsx)("li",{children:"Play a Wild card or a Wild Draw Four card"}),(0,s.jsx)("li",{children:"Draw the top card from the deck and play it if possible"})]}),(0,s.jsx)("p",{children:"Cards are played by laying them face-up on top of the discard pile. Play initially proceeds clockwise around the table."}),(0,s.jsx)("p",{children:"Action or Wild cards have the following effects:"}),(0,s.jsx)("table",{children:(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Card"}),(0,s.jsx)("th",{children:"Effect when played from hand"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Skip"}),(0,s.jsx)("td",{children:"Next player in sequence misses a turn"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Reverse"}),(0,s.jsx)("td",{children:"Order of play switches directions (clockwise to counterclockwise, or vice versa)"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Draw Two (+2)"}),(0,s.jsx)("td",{children:"Next player in sequence draws two cards and misses a turn"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Wild"}),(0,s.jsx)("td",{children:"Player declares the next color to be matched (may be used on any turn even if the player has matching color)"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"Wild Draw Four"}),(0,s.jsx)("td",{children:"Player declares the next color to be matched; next player in sequence draws four cards and misses a turn (may be used on any turn even if the player has matching color)"})]})]})}),(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"A player who draws a playable card from the deck must either play or keep that card and may play no other card from their hand on that turn."}),(0,s.jsx)("li",{children:"A player may play a Wild card or a Wild Draw Four card at any time, even if that player has other playable cards."}),(0,s.jsx)("li",{children:"When playing a Wild or Wild Draw Four card, a player may declare the current color as the next one to be matched."}),(0,s.jsx)("li",{children:"If the draw deck runs out during play, the top discard is set aside and the rest of the pile is shuffled to create a new deck. Play then proceeds normally."}),(0,s.jsx)("li",{children:"It is illegal to trade cards of any sort with another player."})]}),(0,s.jsx)("p",{children:'A player who plays their penultimate card must call "Uno" as a warning to the other players (the system will call for you)'}),(0,s.jsx)("p",{children:'The first player to get rid of their last card ("going out") wins.'})]})]}),(0,s.jsx)("div",{className:"btn-container",children:(0,s.jsx)("div",{className:"btn",onClick:t,children:"Back"})})]})},W=a(5753),B=function(e){let{title:t,dirToGame:a,loadData:r,setShowData:n,getCurrentData:i,gameData:l,setGameData:d}=e;function c(e){let{data:n,index:c}=e;return(0,s.jsxs)("div",{className:"data-model",children:[(0,s.jsx)("div",{className:"container",onClick:"Save"===t?()=>(function(e){let t;do t=window.prompt("Please enter the file name you want to save:");while(null!==t&&""===t);let a=i();W.Z.deleteGameData(a.user,e),a.index=e,a.name=t,W.Z.saveGameData(a).then(()=>{window.alert("Success to save the file!"),l[e]=a,d([...l])}).catch(e=>{window.alert("Fail to save the file, please try again")})})(c):()=>r(c,a),children:n.index?(0,s.jsx)("img",{src:"./img/file.png",alt:"File Saved",width:"230",height:"160"}):(0,s.jsx)("img",{src:"./img/empty.png",alt:"Empty-File",width:"230",height:"160"})}),(0,s.jsx)("p",{children:n.index?n.name:"Empty File"})]})}return(0,s.jsxs)("div",{className:"model-content",children:[(0,s.jsx)("style",{children:"\n          .data-content{\n            display:flex;\n            justify-content: center;\n            padding: 1.5rem;\n            height:85%;\n          }\n          h1{\n            position:absolute;\n            top:10px;\n            left:10px;\n          }\n          .main-container{\n            top:15px;\n            display:flex;\n            flex-wrap:wrap;\n            \n            position:absolute;\n            height:80%;\n            width:80%;\n            border:5px solid blue;\n            \n          }\n          .data-model{\n            flex:1;\n            min-width: 40%;\n            border:5px solid gray;\n            align-items: center;\n          }\n          .container{\n            display:flex;\n            justify-content: center;\n            padding:5px;\n          }\n          .container:hover {\n            cursor:pointer;\n          }\n          .data-model:hover {\n            border:5px solid green;\n          }\n          p{\n            display:flex;\n            justify-content: center;\n            position:relative;\n          }\n          "}),(0,s.jsxs)("div",{className:"data-content",children:[(0,s.jsx)("h1",{children:t}),(0,s.jsxs)("div",{className:"main-container",children:[(0,s.jsx)(c,{index:0,data:l[0]},0),(0,s.jsx)(c,{index:1,data:l[1]},1),(0,s.jsx)(c,{index:2,data:l[2]},2),(0,s.jsx)(c,{index:3,data:l[3]},3)]})]}),(0,s.jsx)("div",{className:"btn-container",children:(0,s.jsx)("div",{className:"btn",onClick:function(){n(!1)},children:"Back"})})]})},I=function(e){let{user:t,isPause:a,setIsPause:n,backHome:i,showData:l,loadData:d,loadGame:c,dirToGame:o,setShowData:u,getCurrentData:h,gameData:m,setGameData:g}=e,[p,f]=(0,r.useState)(!1),[x,y]=(0,r.useState)("Load");function v(){f(!p)}return(0,s.jsxs)("div",{className:"model-setting",children:[!p&&!l&&(0,s.jsxs)("div",{className:"model-content-setting",children:[(0,s.jsx)("div",{className:"menu-bar",onClick:function(){n(!a)},children:"Resume"}),(0,s.jsx)("div",{className:"menu-bar",onClick:v,children:"Rule"}),(0,s.jsx)("div",{className:"menu-bar",onClick:()=>{y("Save"),u(!0)},children:"Save"}),(0,s.jsx)("div",{className:"menu-bar",onClick:()=>{y("Load"),u(!0)},children:"Load"}),(0,s.jsx)("div",{className:"menu-bar",onClick:i,children:"Exit the Game"})]}),p&&!l&&(0,s.jsx)(T,{toggleRule:v}),l&&!p&&(0,s.jsx)(B,{title:x,loadData:d,dirToGame:o,setShowData:u,getCurrentData:h,gameData:m,setGameData:g})]})};class M extends h{updateStatus(){return this.cards.length>4?this.status="Normal":this.cards.length<5&&this.cards.length>2?this.status="Urgent":2==this.cards.length?this.status="Critical":1==this.cards.length?this.status="UNO":this.status="Winner"}getMaxSuit(){let e=[],t={};return this.cards.forEach(e=>{t[e.suit]?t[e.suit]++:t[e.suit]=1}),Object.entries(t).forEach(a=>{let[s,r]=a;0==e.length||t[e[0]]==r?e.push(s):t[e[0]]<r&&(e=[]).push(s)}),e}getMaxValue(){let e=[],t={};return this.cards.forEach(e=>{t[e.value]?t[e.value]++:t[e.value]=1}),Object.entries(t).forEach(a=>{let[s,r]=a;0==e.length||t[e[0]]==r?e.push(s):t[e[0]]<r&&(e=[]).push(s)}),e}constructor(e="NPC",t,a){super(a,t),this.name=e,this.status="Normal"}}var _=function(){let e=(0,n.useRouter)(),[t,a]=(0,r.useState)(!1),[l,g]=(0,r.useState)(!1),[p,v]=(0,r.useState)(W.Z.getCurrentUser()),[w,T]=(0,r.useState)([!1,!1,!1]),[_,A]=(0,r.useState)(!1),[F,G]=(0,r.useState)(!1),[O,U]=(0,r.useState)(!0),[Y,Z]=(0,r.useState)(!1),[L,X]=(0,r.useState)(!1),[z,V]=(0,r.useState)(!1),[q,H]=(0,r.useState)(!1),Q=e=>new Promise(t=>setTimeout(t,e)),J=p?p.user:"Player",K=null,[$,ee]=(0,r.useState)([{},{},{},{}]),et=[J,"AI-1","AI-2","AI-3"],ea=new M(et[0],".player-bot"),es=new M(et[1],".player-left"),er=new M(et[2],".player-top"),en=new M(et[3],".player-right"),ei=[ea,es,er,en],el=new h(function(){let e=[];for(let t=0;t<2;t++)for(let a=0;a<d.length;a++){let s=d[a];for(let a=0;a<o.length;a++){if(1===t&&0===a)continue;let r=o[a],n=new m(s,r);e.push(n)}}for(let t=0;t<4;t++)for(let t=0;t<c.length;t++){let a=c[t];for(let t=0;t<u.length;t++){let s=u[t],r=new m(a,s);e.push(r)}}return e}(),".main-deck"),ed=new h([],".discard-pile"),[ec,eo]=(0,r.useState)(et),[eu,eh]=(0,r.useState)(null),[em,eg]=(0,r.useState)(ea.cards),[ep,ef]=(0,r.useState)(es.cards),[ex,ey]=(0,r.useState)(er.cards),[ev,ew]=(0,r.useState)(en.cards),[ej,eb]=(0,r.useState)(el.cards),[ek,eC]=(0,r.useState)(ed.cards),[eN,eS]=(0,r.useState)(null),eD=()=>{e.push("/")},eP=(0,r.useRef)(null),eE=(0,r.useRef)(null),eR=(0,r.useRef)(null),eT=(0,r.useRef)(null),eW=(0,r.useRef)(null),eB=(0,r.useRef)(null),eI=[{dom:eP,finishTime:0},{dom:eE,finishTime:0},{dom:eR,finishTime:0},{dom:eT,finishTime:0},{dom:eW,finishTime:0},{dom:eB,finishTime:0}],eM={deal:{path:"audio/card-delt.mp3",type:"audio/mpeg",duration:500,volume:1},play:{path:"audio/card-play.mp3",type:"audio/mpeg",duration:500,volume:1},action:{path:"audio/card-action.mp3",type:"audio/mpeg",duration:500,volume:1},reject:{path:"audio/card-reject.mp3",type:"audio/mpeg",duration:500,volume:1},call:{path:"audio/uno-call.mp3",type:"audio/mpeg",duration:500,volume:.5},gameOver:{path:"audio/game-win.mp3",type:"audio/mpeg",duration:2e3,volume:1}};function e_(e){let t=new Date().getTime(),a=eI.find(e=>e.finishTime<t);a?(a.dom.current.setAttribute("src",e.path),a.dom.current.setAttribute("type",e.type),a.dom.current.volume=e.volume,a.finishTime=t+e.duration,setTimeout(()=>a.dom.current.play(),0)):console.log("Unable to play",e.path)}(0,r.useEffect)(()=>{W.Z.getGameData(J).then(e=>{let t=[{},{},{},{}];e.data.forEach((e,a)=>{t[e.index]=e}),ee(t)}).catch(()=>{ee([{},{},{},{}])})},[]),(0,r.useEffect)(()=>{l&&(0===em.length&&(K=ea.name),0===ep.length&&(K=es.name),0===ex.length&&(K=er.name),0===ev.length&&(K=en.name)),K&&(U(!1),e_(eM.gameOver),eS(K),Z(!0))},[eu,$]);let eA=async()=>{g(!0),K=null,el.shuffle(),await Q(500);let e=0;for(;e<7;){for(let e of ei)await eF(el,e,200);e++}do await eF(el,ed,1e3);while("Wild"==ed.getBot().suit);eU()};async function eF(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,s=e.getHit(1);for(t.addBot(s),eO(),await Q(1),t.name?x(t.getWeb().lastElementChild,a,e_,eM):x(ed.getWeb().lastElementChild,a,e_,eM);ed.length>10;){let t=ed.getHit();e.addBot(t),e.shuffle()}await Q(a+1),H(!0)}async function eG(e,t,a){var s;let r,n,i,l,d,c,o,u,h,m,g=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3,p=e.getWeb().children[a].getBoundingClientRect(),f=e.detCard(a);t.addBot(f),eO(),await Q(1),n=(r=(s=t.getWeb().lastElementChild).getBoundingClientRect()).x+r.width/2,i=r.y+r.height/2,l=p.x+p.width/2,d=p.y+p.height/2,c=180,("AI-1"!==e.name||"AI-2"!==e.name||"AI-3"!==e.name)&&(c=0),o=Math.floor(360*Math.random()-180),u=Math.floor(20*Math.random())-10,h=Math.floor(20*Math.random())-10,m=[{transform:"translate3d(".concat((l-n)/10,"rem, ").concat((d-i)/10,"rem, 10rem) rotateY(").concat(c,"deg)")},{transform:"translate3d(0, 0, 10rem) rotate(".concat(o/2,"deg)"),offset:.5},{transform:"translateX(".concat(u/10,"rem) translateY(").concat(h/10,"rem) rotate(").concat(o,"deg)")}],s.lastElementChild.animate(m,{duration:g,easing:"ease-out"}),s.lastElementChild.style.transform="translateX(".concat(u/10,"rem) translateY(").concat(h/10,"rem) rotate(").concat(o,"deg)"),e_(eM.play),await Q(g+1),H(!0)}function eO(){eg([...ea.cards]),ef([...es.cards]),ey([...er.cards]),ew([...en.cards]),eb([...el.cards]),eC([...ed.cards])}function eU(){let e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=1;for(t&&(a=2);0!==a;)_?(e=ec.pop(),ec.unshift(e)):(e=ec.shift(),ec.push(e)),a--;eo([...ec]),eh(e)}function eY(){V(!0)}function eZ(e,t){if($[e].index){let s=$[e],[r,n,i,l,d,c]=[[],[],[],[],[],[]];s.p1.forEach(e=>r.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),s.p2.forEach(e=>n.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),s.p3.forEach(e=>i.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),s.p4.forEach(e=>l.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),s.main.forEach(e=>d.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),s.discard.forEach(e=>c.push(new m(e.suit,e.value,e.points,e.wildColor,e.hasPenalty))),ea.cards=r,es.cards=n,er.cards=i,en.cards=l,el.cards=d,ed.cards=c,eO(),eh(s.currentPlayer),eo(s.currentPlayerQueue),A(s.isReverse),H(!0),t?(g(!0),V(!1)):(a(!1),X(!1))}}function eL(){}function eX(e,t){return 0!==t.length&&("Wild"==e.suit||e.suit==t.getBot().suit||e.suit==t.getBot().wildColor||e.value==t.getBot().value)}return(0,s.jsxs)("div",{className:"game-body",children:[Y&&(0,s.jsx)(R,{winner:eN,backHome:eD,startGame:eA,setIsGameOver:Z}),!l&&!Y&&!L&&!z&&(0,s.jsx)("div",{className:"model-menu",children:(0,s.jsxs)("div",{className:"model-content-menu",children:[(0,s.jsx)("div",{className:"bar-btn",onClick:eA,children:"Start"}),(0,s.jsx)("div",{className:"bar-btn",onClick:eY,children:"Load"}),(0,s.jsx)("div",{className:"bar-btn",onClick:eD,children:"Exit"})]})}),z&&(0,s.jsx)("div",{className:"model-setting",children:(0,s.jsx)(B,{title:"Load",showData:L,setShowData:V,dirToGame:!0,loadData:eZ,gameData:$,setGameData:ee})}),l&&!Y&&(0,s.jsxs)("div",{className:"game-board",children:[(0,s.jsx)("div",{className:"deck box1",children:(0,s.jsx)(i,{deck:ea,deckCards:em,hit:eF,play:eG,showSwitch:w,isPlayOpt:F,setIsPlayOpt:G,avaCheck:eX,getNextPlayer:eU,mainDeck:el,discard:ed,mainCards:ej,setMainCards:eb,discardCards:ek,setDiscardCards:eC,currentPlayer:eu})}),(0,s.jsxs)("div",{className:"deck box2",children:[(0,s.jsx)(j,{name:er.name,pos:"p3",currentPlayer:eu}),w[2]&&eu===er.name&&(0,s.jsx)(P,{showSwitch:w,setSwitch:T,getNextPlayer:eU,hit:eF,mainDeck:el,currentMainCards:ej,deck:er,currentDeckCards:ex,actCard:ek[ek.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eL,play:eG,hit:eF,broadcastSE:e_,SE:eM,isReverse:_,setIsReverse:A,userName:ea.name,avaCheck:eX,showSwitch:w,setSwitch:T,getNextPlayer:eU,deck:er,mainDeck:el,discard:ed,deckCards:ex,setDeckCards:ey,discardCards:ek,setDiscardCards:eC,mainCards:ej,setMainCards:eb,pos:"player-top",currentPlayer:eu,setCurrentPlayer:eh})]}),(0,s.jsxs)("div",{className:"deck box3",children:[(0,s.jsx)(S,{isBGM:O}),(0,s.jsx)(C,{isPause:t,setIsPause:a,currentPlayer:eu,user:J})]}),(0,s.jsxs)("div",{className:"deck box4",children:[(0,s.jsx)(j,{name:es.name,pos:"p2",currentPlayer:eu}),w[2]&&eu===es.name&&(0,s.jsx)(P,{showSwitch:w,setSwitch:T,getNextPlayer:eU,hit:eF,mainDeck:el,currentMainCards:ej,deck:es,currentDeckCards:ep,actCard:ek[ek.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eL,play:eG,hit:eF,broadcastSE:e_,SE:eM,isReverse:_,setIsReverse:A,userName:ea.name,avaCheck:eX,showSwitch:w,setSwitch:T,getNextPlayer:eU,deck:es,mainDeck:el,discard:ed,deckCards:ep,setDeckCards:ef,discardCards:ek,setDiscardCards:eC,mainCards:ej,setMainCards:eb,pos:"player-left",currentPlayer:eu,setCurrentPlayer:eh})]}),(0,s.jsxs)("div",{className:"deck box5",children:[w[0]&&(0,s.jsx)(k,{setSwitch:T,getNextPlayer:eU,discard:ed,currentDiscardCards:ek}),w[1]&&(0,s.jsx)(D,{broadcastSE:e_,SE:eM,isReverse:_,setIsReverse:A,setSwitch:T,getNextPlayer:eU,discard:ed,currentDiscardCards:ek}),(0,s.jsx)(b,{cards:ek,showCard:q}),(0,s.jsx)(N,{isReverse:_})]}),(0,s.jsxs)("div",{className:"deck box6",children:[(0,s.jsx)(j,{name:en.name,pos:"p4",currentPlayer:eu}),w[2]&&eu===en.name&&(0,s.jsx)(P,{showSwitch:w,setSwitch:T,getNextPlayer:eU,hit:eF,mainDeck:el,currentMainCards:ej,deck:en,currentDeckCards:ev,actCard:ek[ek.length-1]}),(0,s.jsx)(f,{showCard:q,isPause:t,pauseEvent:eL,play:eG,hit:eF,broadcastSE:e_,SE:eM,isReverse:_,setIsReverse:A,userName:ea.name,avaCheck:eX,showSwitch:w,setSwitch:T,getNextPlayer:eU,deck:en,mainDeck:el,discard:ed,deckCards:ev,setDeckCards:ew,discardCards:ek,setDiscardCards:eC,mainCards:ej,setMainCards:eb,pos:"player-right",currentPlayer:eu,setCurrentPlayer:eh})]}),(0,s.jsx)("div",{className:"deck box7"}),(0,s.jsxs)("div",{className:"deck box8",children:[(0,s.jsx)(j,{name:ea.name,pos:"p1",currentPlayer:eu}),w[2]&&eu===ea.name&&(0,s.jsx)(P,{showSwitch:w,setSwitch:T,getNextPlayer:eU,hit:eF,mainDeck:el,currentMainCards:ej,deck:ea,currentDeckCards:em,actCard:ek[ek.length-1]}),F&&eu===ea.name&&(0,s.jsx)(E,{play:eG,broadcastSE:e_,SE:eM,isPlayOpt:F,setIsPlayOpt:G,setSwitch:T,isReverse:_,setIsReverse:A,getNextPlayer:eU,deck:ea,deckCards:em,discard:ed,discardCards:ek}),(0,s.jsx)(y,{showCard:q,play:eG,broadcastSE:e_,SE:eM,avaCheck:eX,showSwitch:w,setSwitch:T,isReverse:_,setIsReverse:A,getNextPlayer:eU,deck:ea,mainDeck:el,discard:ed,deckCards:em,setDeckCards:eg,discardCards:ek,setDiscardCards:eC,mainCards:ej,setMainCards:eb,pos:"player-bot",currentPlayer:eu,setCurrentPlayer:eh})]}),(0,s.jsx)("div",{className:"deck box9"})]}),t&&(0,s.jsx)(I,{user:J,isPause:t,setIsPause:a,backHome:eD,showData:L,loadData:eZ,loadGame:eY,dirToGame:!1,setShowData:X,getCurrentData:function(){return{user:J,date:new Date().getTime(),currentPlayer:eu,currentPlayerQueue:ec,isReverse:_,main:ej,discard:ek,p1:em,p2:ep,p3:ex,p4:ev}},gameData:$,setGameData:ee}),(0,s.jsx)("audio",{ref:eP}),(0,s.jsx)("audio",{ref:eE}),(0,s.jsx)("audio",{ref:eR}),(0,s.jsx)("audio",{ref:eT}),(0,s.jsx)("audio",{ref:eW}),(0,s.jsx)("audio",{ref:eB})]})}},5753:function(e,t,a){"use strict";var s=a(6154);let r="https://uno-game-server.glitch.me/api";t.Z=new class{login(e,t){return s.Z.post(r+"/user/login",{username:e,password:t})}logout(){localStorage.removeItem("user")}register(e,t,a,n,i){return s.Z.post(r+"/user/register",{username:e,email:t,password:a,gender:n,role:i})}getCurrentUser(){return JSON.parse(localStorage.getItem("user"))||null}modifyUser(e,t,a,n,i){return s.Z.patch(r+"/user/modify/"+e,{username:t,email:a,password:n,gender:i})}deleteUser(e){return s.Z.delete(r+"/user/delete/"+e)}getGameData(e){return s.Z.get(r+"/gameData/"+e)}saveGameData(e){let{user:t,index:a,name:n,date:i,currentPlayer:l,currentPlayerQueue:d,isReverse:c,main:o,discard:u,p1:h,p2:m,p3:g,p4:p}=e;return s.Z.post(r+"/gameData/data",{user:t,index:a,name:n,date:i,currentPlayer:l,currentPlayerQueue:d,isReverse:c,main:o,discard:u,p1:h,p2:m,p3:g,p4:p})}deleteGameData(e,t){return s.Z.delete(r+"/gameData/"+e+"/"+t)}deleteGameDataAll(e){return s.Z.delete(r+"/gameData/"+e)}}}},function(e){e.O(0,[827,675,774,888,179],function(){return e(e.s=3874)}),_N_E=e.O()}]);